apiVersion: v1
kind: Namespace
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
    control-plane: inference-gateway-operator
  name: inference-gateway-system
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.2
  name: a2aservers.core.inference-gateway.com
spec:
  group: core.inference-gateway.com
  names:
    kind: A2AServer
    listKind: A2AServerList
    plural: a2aservers
    singular: a2aserver
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: A2AServer is the Schema for the a2aservers API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: A2AServerSpec defines the desired state of A2AServer.
            properties:
              agent:
                properties:
                  apiKey:
                    properties:
                      secretRef:
                        type: string
                    required:
                    - secretRef
                    type: object
                  enabled:
                    type: boolean
                  llm:
                    properties:
                      customHeaders:
                        items:
                          properties:
                            name:
                              type: string
                            value:
                              type: string
                          required:
                          - name
                          - value
                          type: object
                        type: array
                      maxTokens:
                        format: int32
                        type: integer
                      model:
                        type: string
                      systemPrompt:
                        type: string
                      temperature:
                        type: string
                    required:
                    - customHeaders
                    - maxTokens
                    - model
                    - systemPrompt
                    - temperature
                    type: object
                  maxChatCompletionIterations:
                    format: int32
                    type: integer
                  maxConversationHistory:
                    format: int32
                    type: integer
                  maxRetries:
                    format: int32
                    type: integer
                  tls:
                    properties:
                      enabled:
                        type: boolean
                      secretRef:
                        type: string
                    required:
                    - enabled
                    - secretRef
                    type: object
                required:
                - apiKey
                - enabled
                - llm
                - maxChatCompletionIterations
                - maxConversationHistory
                - maxRetries
                - tls
                type: object
              card:
                properties:
                  capabilities:
                    properties:
                      pushNotifications:
                        type: boolean
                      stateTransitionHistory:
                        type: boolean
                      streaming:
                        type: boolean
                    required:
                    - pushNotifications
                    - stateTransitionHistory
                    - streaming
                    type: object
                  defaultInputModes:
                    items:
                      type: string
                    type: array
                  defaultOutputModes:
                    items:
                      type: string
                    type: array
                  description:
                    type: string
                  documentationUrl:
                    type: string
                  name:
                    type: string
                  skills:
                    items:
                      type: string
                    type: array
                  url:
                    type: string
                required:
                - capabilities
                - defaultInputModes
                - defaultOutputModes
                - description
                - documentationUrl
                - name
                - skills
                - url
                type: object
              host:
                type: string
              idleTimeout:
                type: string
              image:
                type: string
              logging:
                properties:
                  format:
                    type: string
                  level:
                    type: string
                required:
                - format
                - level
                type: object
              port:
                format: int32
                type: integer
              queue:
                properties:
                  cleanupInterval:
                    type: string
                  enabled:
                    type: boolean
                  maxSize:
                    format: int32
                    type: integer
                required:
                - cleanupInterval
                - enabled
                - maxSize
                type: object
              readTimeout:
                type: string
              telemetry:
                description: TelemetrySpec contains telemetry and observability configuration
                properties:
                  enabled:
                    default: true
                    description: Enable telemetry collection
                    type: boolean
                  metrics:
                    description: Metrics configuration
                    properties:
                      enabled:
                        default: true
                        description: Enable metrics collection
                        type: boolean
                      port:
                        default: 9464
                        description: Port for metrics endpoint
                        format: int32
                        maximum: 65535
                        minimum: 1024
                        type: integer
                    type: object
                  tracing:
                    description: Tracing configuration
                    properties:
                      enabled:
                        default: false
                        description: Enable tracing
                        type: boolean
                      endpoint:
                        description: Tracing endpoint URL
                        type: string
                    type: object
                type: object
              timezone:
                type: string
              tls:
                properties:
                  enabled:
                    type: boolean
                  secretRef:
                    type: string
                required:
                - enabled
                - secretRef
                type: object
              writeTimeout:
                type: string
            required:
            - agent
            - card
            - host
            - idleTimeout
            - image
            - logging
            - port
            - queue
            - readTimeout
            - telemetry
            - timezone
            - tls
            - writeTimeout
            type: object
          status:
            description: A2AServerStatus defines the observed state of A2AServer.
            properties:
              conditions:
                description: Conditions represent the latest available observations
                  of the resource's state.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              observedGeneration:
                description: ObservedGeneration is the most recent generation observed
                  for this resource.
                format: int64
                type: integer
              ready:
                description: Ready indicates if the resource is ready.
                type: boolean
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.2
  name: gateways.core.inference-gateway.com
spec:
  group: core.inference-gateway.com
  names:
    kind: Gateway
    listKind: GatewayList
    plural: gateways
    singular: gateway
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Gateway IP address
      jsonPath: .spec.server.host
      name: IP
      type: string
    - description: Gateway port
      jsonPath: .spec.server.port
      name: Port
      type: integer
    - description: Configured providers
      jsonPath: .status.providerSummary
      name: Providers
      type: string
    - description: Age of the resource
      jsonPath: .metadata.creationTimestamp
      name: AGE
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Gateway is the Schema for the gateways API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: GatewaySpec defines the desired state of Gateway.
            properties:
              a2a:
                description: A2A (Agent-to-Agent) configuration
                properties:
                  agents:
                    description: A2A agents configuration
                    items:
                      description: A2AAgent contains A2A agent configuration
                      properties:
                        healthCheck:
                          description: Health check configuration
                          properties:
                            enabled:
                              default: true
                              description: Enable health checks
                              type: boolean
                            interval:
                              default: 30s
                              description: Health check interval
                              type: string
                            path:
                              default: /health
                              description: Health check path
                              type: string
                          type: object
                        name:
                          description: Agent name
                          type: string
                        url:
                          description: Agent URL
                          type: string
                      required:
                      - name
                      - url
                      type: object
                    type: array
                  enabled:
                    default: false
                    description: Enable A2A integration
                    type: boolean
                  expose:
                    default: false
                    description: Expose A2A endpoints externally
                    type: boolean
                  polling:
                    description: Polling configuration
                    properties:
                      enabled:
                        default: true
                        description: Enable polling
                        type: boolean
                      interval:
                        default: 2s
                        description: Polling interval
                        type: string
                      maxAttempts:
                        default: 30
                        description: Maximum polling attempts
                        format: int32
                        maximum: 1000
                        minimum: 1
                        type: integer
                      timeout:
                        default: 60s
                        description: Polling timeout
                        type: string
                    type: object
                  timeouts:
                    description: A2A client timeouts
                    properties:
                      client:
                        default: 60s
                        description: Client timeout
                        type: string
                    type: object
                type: object
              auth:
                description: Authentication configuration
                properties:
                  enabled:
                    default: false
                    description: Enable authentication
                    type: boolean
                  oidc:
                    description: OIDC configuration
                    properties:
                      clientId:
                        default: inference-gateway-client
                        type: string
                      clientSecretRef:
                        description: Reference to a secret containing the client secret
                        properties:
                          key:
                            default: value
                            description: Key within the secret
                            type: string
                          name:
                            description: Name of the secret
                            type: string
                          namespace:
                            description: Namespace of the secret (defaults to Gateway
                              namespace)
                            type: string
                        required:
                        - name
                        type: object
                      issuerUrl:
                        default: http://keycloak:8080/realms/inference-gateway-realm
                        type: string
                    type: object
                  provider:
                    default: oidc
                    description: Authentication provider type
                    enum:
                    - oidc
                    - jwt
                    - basic
                    type: string
                type: object
              environment:
                default: production
                description: Environment defines the environment type (development,
                  staging, production)
                enum:
                - development
                - staging
                - production
                type: string
              hpa:
                description: HPA (Horizontal Pod Autoscaler) configuration
                properties:
                  customMetrics:
                    description: Custom metrics for scaling
                    items:
                      description: HPACustomMetric contains custom metric configuration
                        for HPA
                      properties:
                        name:
                          description: Metric name
                          type: string
                        target:
                          description: Target value for the metric
                          properties:
                            averageUtilization:
                              description: Target average utilization percentage (for
                                Utilization type)
                              format: int32
                              maximum: 100
                              minimum: 1
                              type: integer
                            type:
                              description: Target type (Utilization, Value, AverageValue)
                              enum:
                              - Utilization
                              - Value
                              - AverageValue
                              type: string
                            value:
                              description: Target value (for Value and AverageValue
                                types)
                              type: string
                          required:
                          - type
                          type: object
                        type:
                          description: Metric type (Resource, Pods, Object, External)
                          enum:
                          - Resource
                          - Pods
                          - Object
                          - External
                          type: string
                      required:
                      - name
                      - target
                      - type
                      type: object
                    type: array
                  enabled:
                    default: false
                    description: Enable HPA
                    type: boolean
                  maxReplicas:
                    default: 10
                    description: Maximum number of replicas
                    format: int32
                    maximum: 1000
                    minimum: 1
                    type: integer
                  minReplicas:
                    default: 1
                    description: Minimum number of replicas
                    format: int32
                    maximum: 100
                    minimum: 1
                    type: integer
                  scaleDownStabilizationWindowSeconds:
                    default: 300
                    description: Scale down stabilization window (in seconds)
                    format: int32
                    type: integer
                  scaleUpStabilizationWindowSeconds:
                    default: 0
                    description: Scale up stabilization window (in seconds)
                    format: int32
                    type: integer
                  targetCPUUtilizationPercentage:
                    default: 80
                    description: Target CPU utilization percentage
                    format: int32
                    maximum: 100
                    minimum: 1
                    type: integer
                  targetMemoryUtilizationPercentage:
                    description: Target memory utilization percentage
                    format: int32
                    maximum: 100
                    minimum: 1
                    type: integer
                type: object
              image:
                default: ghcr.io/inference-gateway/inference-gateway:latest
                description: Image is the container image to use for the gateway deployment
                type: string
              ingress:
                description: Ingress configuration
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    description: Ingress annotations
                    type: object
                  className:
                    description: Ingress class name
                    type: string
                  enabled:
                    default: false
                    description: Enable ingress
                    type: boolean
                  host:
                    description: |-
                      Simple host configuration (alternative to hosts array)
                      When specified, this will be used as the primary host with automatic TLS and path configuration
                    type: string
                  hosts:
                    description: |-
                      Ingress hosts configuration (advanced usage)
                      Use 'host' field for simple single-host configuration
                    items:
                      description: IngressHost contains ingress host configuration
                      properties:
                        host:
                          description: Host name
                          type: string
                        paths:
                          description: Paths configuration
                          items:
                            description: IngressPath contains ingress path configuration
                            properties:
                              path:
                                description: Path
                                type: string
                              pathType:
                                default: Prefix
                                description: Path type
                                enum:
                                - Exact
                                - Prefix
                                - ImplementationSpecific
                                type: string
                            required:
                            - path
                            type: object
                          type: array
                      required:
                      - host
                      type: object
                    type: array
                  tls:
                    description: TLS configuration
                    properties:
                      config:
                        description: Advanced TLS configuration (alternative to simple
                          config above)
                        items:
                          description: IngressTLS contains ingress TLS configuration
                          properties:
                            hosts:
                              description: Hosts covered by the certificate
                              items:
                                type: string
                              type: array
                            secretName:
                              description: Secret name containing TLS certificate
                              type: string
                          required:
                          - secretName
                          type: object
                        type: array
                      enabled:
                        default: true
                        description: Enable TLS for ingress
                        type: boolean
                      issuer:
                        description: |-
                          Certificate issuer for cert-manager (automatically sets annotation)
                          Examples: "letsencrypt-prod", "letsencrypt-staging", "selfsigned-issuer"
                        type: string
                      secretName:
                        description: Secret name for TLS certificate (auto-generated
                          if not specified)
                        type: string
                    type: object
                type: object
              mcp:
                description: MCP (Model Context Protocol) configuration
                properties:
                  enabled:
                    default: false
                    description: Enable MCP integration
                    type: boolean
                  expose:
                    default: false
                    description: Expose MCP endpoints externally
                    type: boolean
                  servers:
                    description: MCP servers configuration
                    items:
                      description: MCPServer contains MCP server configuration
                      properties:
                        healthCheck:
                          description: Health check configuration
                          properties:
                            enabled:
                              default: true
                              description: Enable health checks
                              type: boolean
                            interval:
                              default: 30s
                              description: Health check interval
                              type: string
                            path:
                              default: /health
                              description: Health check path
                              type: string
                          type: object
                        name:
                          description: Server name
                          type: string
                        url:
                          description: Server URL
                          type: string
                      required:
                      - name
                      - url
                      type: object
                    type: array
                  timeouts:
                    description: MCP client timeouts
                    properties:
                      client:
                        default: 10s
                        description: Client timeout
                        type: string
                      dial:
                        default: 5s
                        description: Dial timeout
                        type: string
                      request:
                        default: 10s
                        description: Request timeout
                        type: string
                      responseHeader:
                        default: 5s
                        description: Response header timeout
                        type: string
                      tlsHandshake:
                        default: 5s
                        description: TLS handshake timeout
                        type: string
                    type: object
                type: object
              providers:
                description: Provider configurations for AI/ML backends
                items:
                  description: ProviderSpec contains configuration for a specific
                    provider
                  properties:
                    config:
                      description: Provider configuration
                      properties:
                        authType:
                          description: Authentication type
                          enum:
                          - bearer
                          - basic
                          - none
                          type: string
                        baseUrl:
                          description: Base URL for the provider API
                          type: string
                        tokenRef:
                          description: Reference to secret containing authentication
                            token
                          properties:
                            key:
                              default: value
                              description: Key within the secret
                              type: string
                            name:
                              description: Name of the secret
                              type: string
                            namespace:
                              description: Namespace of the secret (defaults to Gateway
                                namespace)
                              type: string
                          required:
                          - name
                          type: object
                      type: object
                    name:
                      description: Provider name (unique identifier)
                      type: string
                    type:
                      description: Provider type
                      enum:
                      - openai
                      - anthropic
                      - ollama
                      - groq
                      - cohere
                      - cloudflare
                      - deepseek
                      type: string
                  required:
                  - name
                  - type
                  type: object
                type: array
              replicas:
                default: 1
                description: Replicas is the number of gateway instances to run
                format: int32
                maximum: 100
                minimum: 1
                type: integer
              resources:
                description: Resource requirements for the gateway pods
                properties:
                  limits:
                    description: Resource limits
                    properties:
                      cpu:
                        description: CPU resource specification
                        type: string
                      memory:
                        description: Memory resource specification
                        type: string
                    type: object
                  requests:
                    description: Resource requests
                    properties:
                      cpu:
                        description: CPU resource specification
                        type: string
                      memory:
                        description: Memory resource specification
                        type: string
                    type: object
                type: object
              server:
                description: Server configuration
                properties:
                  host:
                    default: 0.0.0.0
                    description: Server host
                    type: string
                  port:
                    default: 8080
                    description: Server port
                    format: int32
                    maximum: 65535
                    minimum: 1024
                    type: integer
                  timeouts:
                    description: Server timeouts
                    properties:
                      idle:
                        default: 300s
                        description: Idle timeout
                        type: string
                      read:
                        default: 60s
                        description: Read timeout
                        type: string
                      write:
                        default: 60s
                        description: Write timeout
                        type: string
                    type: object
                  tls:
                    description: TLS configuration
                    properties:
                      certificateRef:
                        description: Reference to a secret containing the TLS certificate
                        properties:
                          key:
                            default: value
                            description: Key within the secret
                            type: string
                          name:
                            description: Name of the secret
                            type: string
                          namespace:
                            description: Namespace of the secret (defaults to Gateway
                              namespace)
                            type: string
                        required:
                        - name
                        type: object
                      enabled:
                        default: false
                        description: Enable TLS
                        type: boolean
                      keyRef:
                        description: Reference to a secret containing the TLS private
                          key
                        properties:
                          key:
                            default: value
                            description: Key within the secret
                            type: string
                          name:
                            description: Name of the secret
                            type: string
                          namespace:
                            description: Namespace of the secret (defaults to Gateway
                              namespace)
                            type: string
                        required:
                        - name
                        type: object
                    type: object
                type: object
              service:
                description: Service configuration
                properties:
                  annotations:
                    additionalProperties:
                      type: string
                    description: Service annotations
                    type: object
                  port:
                    default: 8080
                    description: Service port
                    format: int32
                    maximum: 65535
                    minimum: 1
                    type: integer
                  type:
                    default: ClusterIP
                    description: Service type
                    enum:
                    - ClusterIP
                    - NodePort
                    - LoadBalancer
                    - ExternalName
                    type: string
                type: object
              telemetry:
                description: Telemetry configuration for observability
                properties:
                  enabled:
                    default: true
                    description: Enable telemetry collection
                    type: boolean
                  metrics:
                    description: Metrics configuration
                    properties:
                      enabled:
                        default: true
                        description: Enable metrics collection
                        type: boolean
                      port:
                        default: 9464
                        description: Port for metrics endpoint
                        format: int32
                        maximum: 65535
                        minimum: 1024
                        type: integer
                    type: object
                  tracing:
                    description: Tracing configuration
                    properties:
                      enabled:
                        default: false
                        description: Enable tracing
                        type: boolean
                      endpoint:
                        description: Tracing endpoint URL
                        type: string
                    type: object
                type: object
            type: object
          status:
            description: GatewayStatus defines the observed state of Gateway.
            properties:
              availableReplicas:
                description: Current number of available replicas
                format: int32
                type: integer
              conditions:
                description: Current deployment conditions
                items:
                  description: GatewayCondition represents a condition of a Gateway
                    deployment
                  properties:
                    lastTransitionTime:
                      description: Last time the condition transitioned
                      format: date-time
                      type: string
                    message:
                      description: Human readable message indicating details about
                        last transition
                      type: string
                    reason:
                      description: Reason for the condition's last transition
                      type: string
                    status:
                      description: Status of the condition (True, False, Unknown)
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: Type of Gateway condition
                      enum:
                      - Available
                      - Progressing
                      - ReplicaFailure
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              message:
                description: Message provides additional information about the current
                  state
                type: string
              observedGeneration:
                description: ObservedGeneration is the most recent generation observed
                format: int64
                type: integer
              phase:
                description: Phase represents the current phase of the Gateway
                enum:
                - Pending
                - Running
                - Failed
                - Unknown
                type: string
              providerSummary:
                description: ProviderSummary is a comma-separated list of provider
                  names
                type: string
              readyReplicas:
                description: Current number of ready replicas
                format: int32
                type: integer
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
---
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-inference-gateway
  namespace: inference-gateway-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-leader-election-role
  namespace: inference-gateway-system
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - patch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-a2aserver-admin-role
rules:
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers
  verbs:
  - '*'
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers/status
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-a2aserver-editor-role
rules:
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers/status
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-a2aserver-viewer-role
rules:
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers/status
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-gateway-admin-role
rules:
- apiGroups:
  - core.inference-gateway.com
  resources:
  - gateways
  verbs:
  - '*'
- apiGroups:
  - core.inference-gateway.com
  resources:
  - gateways/status
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-gateway-editor-role
rules:
- apiGroups:
  - core.inference-gateway.com
  resources:
  - gateways
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - core.inference-gateway.com
  resources:
  - gateways/status
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-gateway-viewer-role
rules:
- apiGroups:
  - core.inference-gateway.com
  resources:
  - gateways
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - core.inference-gateway.com
  resources:
  - gateways/status
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: operator-manager-role
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  - services
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
  - list
- apiGroups:
  - apps
  resources:
  - deployments
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - autoscaling
  resources:
  - horizontalpodautoscalers
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers
  - gateways
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers/finalizers
  - gateways/finalizers
  verbs:
  - update
- apiGroups:
  - core.inference-gateway.com
  resources:
  - a2aservers/status
  - gateways/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: operator-metrics-auth-role
rules:
- apiGroups:
  - authentication.k8s.io
  resources:
  - tokenreviews
  verbs:
  - create
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: operator-metrics-reader
rules:
- nonResourceURLs:
  - /metrics
  verbs:
  - get
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-leader-election-rolebinding
  namespace: inference-gateway-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: operator-leader-election-role
subjects:
- kind: ServiceAccount
  name: operator-inference-gateway
  namespace: inference-gateway-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
  name: operator-manager-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: operator-manager-role
subjects:
- kind: ServiceAccount
  name: operator-inference-gateway
  namespace: inference-gateway-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: operator-metrics-auth-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: operator-metrics-auth-role
subjects:
- kind: ServiceAccount
  name: operator-inference-gateway
  namespace: inference-gateway-system
---
apiVersion: v1
kind: Service
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
    control-plane: inference-gateway-operator
  name: operator-inference-gateway-metrics-service
  namespace: inference-gateway-system
spec:
  ports:
  - name: http
    port: 9090
    protocol: TCP
    targetPort: 9090
  selector:
    app.kubernetes.io/name: operator
    control-plane: inference-gateway-operator
---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app.kubernetes.io/managed-by: kustomize
    app.kubernetes.io/name: operator
    control-plane: inference-gateway-operator
  name: operator-inference-gateway
  namespace: inference-gateway-system
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: operator
      control-plane: inference-gateway-operator
  strategy:
    type: Recreate
  template:
    metadata:
      annotations:
        kubectl.kubernetes.io/default-container: operator
        prometheus.io/path: /metrics
        prometheus.io/port: "9090"
        prometheus.io/scrape: "true"
      labels:
        app.kubernetes.io/name: operator
        control-plane: inference-gateway-operator
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/arch
                operator: In
                values:
                - amd64
                - arm64
              - key: kubernetes.io/os
                operator: In
                values:
                - linux
      containers:
      - args:
        - --leader-elect
        - --health-probe-bind-address=:8081
        - --metrics-bind-address=:9090
        - --zap-log-level=info
        - --zap-encoder=json
        env:
        - name: WATCH_NAMESPACE_SELECTOR
          value: inference-gateway.com/managed=true
        image: ghcr.io/inference-gateway/operator:latest
        imagePullPolicy: IfNotPresent
        livenessProbe:
          httpGet:
            path: /healthz
            port: 8081
          initialDelaySeconds: 15
          periodSeconds: 20
        name: operator
        ports:
        - containerPort: 9090
          name: metrics
          protocol: TCP
        - containerPort: 8081
          name: health
          protocol: TCP
        readinessProbe:
          httpGet:
            path: /readyz
            port: 8081
          initialDelaySeconds: 5
          periodSeconds: 10
        resources:
          limits:
            cpu: 1000m
            memory: 256Mi
          requests:
            cpu: 100m
            memory: 128Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        volumeMounts: []
      securityContext:
        runAsNonRoot: true
        seccompProfile:
          type: RuntimeDefault
      serviceAccountName: operator-inference-gateway
      terminationGracePeriodSeconds: 10
      volumes: []
